{% extends 'base.html' %}
{% load static %}

{% block title %}Aprovechamiento - Héroes del Planeta{% endblock %}

{% block content %}
<div class="container py-5">
  <h2 class="text-success fw-bold mb-4">
    <i class="bi bi-bar-chart-line-fill"></i> Toneladas Aprovechadas y Rechazadas - 2025
  </h2>

  <div class="row">
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm p-3 chart-container">
        <h5 class="text-center">Toneladas Transportadas y Aprovechadas</h5>
        <canvas id="chartAprovechadas"></canvas>
      </div>
    </div>
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm p-3 chart-container">
        <h5 class="text-center">Rechazos</h5>
        <canvas id="chartRechazos"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- Estilo para tamaño fijo sin deformar -->
<style>
  .chart-container {
    height: 350px; /* ajusta aquí si lo quieres más grande */
    position: relative;
  }
</style>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];

  const toneladasAprovechadas = [437.029, 439.169, 439.776, 440.620, 440.889, 441.131, null, null, null, null, null, null];
  const toneladasRechazos = [0.610, 1.070, 0.628, 2.790, 3.820, null, null, null, null, null, null, null];

  const chartAprovechadas = new Chart(document.getElementById('chartAprovechadas'), {
    type: 'bar',
    data: {
      labels: meses,
      datasets: [{
        label: 'Toneladas Aprovechadas',
        data: toneladasAprovechadas,
        backgroundColor: 'rgba(40, 167, 69, 0.7)',
        borderColor: 'rgba(40, 167, 69, 1)',
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          beginAtZero: false,
          suggestedMin: 430,
          suggestedMax: 400,
          ticks: {
            stepSize: 2
          }
        }
      }
    }
  });

  const chartRechazos = new Chart(document.getElementById('chartRechazos'), {
    type: 'bar',
    data: {
      labels: meses,
      datasets: [{
        label: 'Toneladas Rechazadas',
        data: toneladasRechazos,
        backgroundColor: 'rgba(220, 53, 69, 0.7)',
        borderColor: 'rgba(220, 53, 69, 1)',
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          beginAtZero: true,
          suggestedMax: 5,
          ticks: {
            stepSize: 1
          }
        }
      }
    }
  });
</script>
{% endblock %}
